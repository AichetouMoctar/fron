<!-- src/app/pages/login/login.html -->
<div class="login-page">
  <!-- Background -->
  <div class="bg-element bg-1"></div>
  <div class="bg-element bg-2"></div>
  <div class="bg-element bg-3"></div>

  <!-- Card -->
  <div class="login-card">
    <!-- Header -->
    <div class="login-header">
      <i class="fas fa-bus logo-icon"></i>
      <h1>Wijha</h1>
      <p>Système de Transport</p>
    </div>

    <!-- Body -->
    <div class="login-body">
      <!-- Erreur -->
      @if (errorMessage) {
        <div class="alert alert-error">
          <i class="fas fa-exclamation-circle"></i>
          <span>{{ errorMessage }}</span>
        </div>
      }

      <!-- Formulaire -->
      <form [formGroup]="loginForm" (ngSubmit)="onSubmit()">
        <!-- Email -->
        <div class="form-group">
          <label class="form-label">
            <i class="fas fa-envelope"></i> Adresse Email
          </label>
          <input type="email"
                 class="form-control"
                 formControlName="email"
                 [class.is-invalid]="f['email'].invalid && (f['email'].dirty || f['email'].touched)"
                 placeholder="exemple@email.mr"
                 autocomplete="username">
          @if (f['email'].invalid && (f['email'].dirty || f['email'].touched)) {
            <div class="invalid-feedback">
              <i class="fas fa-exclamation-circle"></i>
              @if (f['email'].errors?.['required']) { <span>L'email est requis</span> }
              @if (f['email'].errors?.['email']) { <span>Format invalide</span> }
            </div>
          }
        </div>

        <!-- Mot de passe -->
        <div class="form-group">
          <label class="form-label">
            <i class="fas fa-lock"></i> Mot de passe
          </label>
          <div class="input-wrapper">
            <input [type]="passwordVisible ? 'text' : 'password'"
                   class="form-control"
                   formControlName="password"
                   [class.is-invalid]="f['password'].invalid && (f['password'].dirty || f['password'].touched)"
                   placeholder="••••••••"
                   autocomplete="current-password">
            <button type="button" class="password-toggle" (click)="togglePassword()">
              <i [class]="passwordVisible ? 'fas fa-eye-slash' : 'fas fa-eye'"></i>
            </button>
          </div>
          @if (f['password'].invalid && (f['password'].dirty || f['password'].touched)) {
            <div class="invalid-feedback">
              <i class="fas fa-exclamation-circle"></i>
              @if (f['password'].errors?.['required']) { <span>Le mot de passe est requis</span> }
              @if (f['password'].errors?.['minlength']) { <span>Minimum 6 caractères</span> }
            </div>
          }
        </div>

        <!-- Bouton -->
        <button type="submit" class="btn-login" [disabled]="loginForm.invalid || isLoading">
          @if (isLoading) { <span class="spinner-border"></span> }
          <i class="fas fa-sign-in-alt"></i> Se connecter
        </button>
      </form>

      <!-- Lien inscription -->
      <div class="login-links">
        <a routerLink="/register">
          <i class="fas fa-user-plus"></i> Pas encore de compte ? S'inscrire
        </a>
      </div>
    </div>
  </div>
</div>